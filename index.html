<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="不积跬步无以至千里">
<meta property="og:url" content="http://blogs.jiaqiang.fun/index.html">
<meta property="og:site_name" content="不积跬步无以至千里">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="不积跬步无以至千里">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blogs.jiaqiang.fun/">





  <title>不积跬步无以至千里</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">不积跬步无以至千里</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/03/15/unity-shader-rendering-path/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/15/unity-shader-rendering-path/" itemprop="url">unity-shader-rendering-path</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-15T14:43:06+08:00">
                2019-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/03/15/unity-shader-light/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/15/unity-shader-light/" itemprop="url">unity的光源</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-15T12:22:57+08:00">
                2019-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="光源类型"><a href="#光源类型" class="headerlink" title="光源类型"></a>光源类型</h5><ul>
<li>平行光</li>
<li>点光源</li>
<li>聚光灯 spot light 可以用于表示由一个特定位置出发、向特定方向延伸的光，锥形区域的半径由面板的Range属性决定，而锥形体的张开角度由spot angle属性决定</li>
<li>面光灯 area light</li>
</ul>
<h5 id="光源属性"><a href="#光源属性" class="headerlink" title="光源属性"></a>光源属性</h5><ul>
<li>位置 position</li>
<li>方向 direction</li>
<li>强度 instensity</li>
<li>颜色 color </li>
<li>衰减 attenuation 到某点的衰减，与该点到光源的距离有关</li>
</ul>
<h5 id="shader实现"><a href="#shader实现" class="headerlink" title="shader实现"></a>shader实现</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Pass&#123;</span><br><span class="line">    Tags&#123;<span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span>&#125;</span><br><span class="line">    CGPROGRAM</span><br><span class="line">    #pragma multi_compile_fwbase</span><br><span class="line">    #pragma vertex vert</span><br><span class="line">    #pragma fragment frag</span><br><span class="line">    <span class="comment">//保证在shader中使用光照衰减等光照变量可以被正确赋值</span></span><br><span class="line">    ENDCG</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="notes"><a href="#notes" class="headerlink" title="notes"></a>notes</h5><p>如果场景中有多个平行光，那么unity会选择最亮的平行光传递给BasePass进行逐像素处理，其他平行光会按照逐顶点或在Additional Pass中按照逐像素的方式处理，如果场景中没有平行光，那么base pass会当成全黑的光源处理。basepass处理的逐像素光源类型一定是平行光。可以使用_WorldLightPos0来得到这个平行光的方向，可以使用 _LightColor0来得到它的颜色和强度，衰减值为1</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/03/15/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/15/hello-world/" itemprop="url">hexo 操作笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-15T05:32:22+08:00">
                2019-03-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hexo/" itemprop="url" rel="index">
                    <span itemprop="name">Hexo</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hexo/tech/" itemprop="url" rel="index">
                    <span itemprop="name">tech</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://hexo.io/docs/" target="_blank" rel="noopener">官方文档</a><br><a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a><br><a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">ask</a></p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ul>
<li><a href="#1">1.基本用法</a><ul>
<li><a href="#1.1">1.1标题</a></li>
<li><a href="#1.2">1.2变粗</a></li>
<li><a href="#1.3">1.3斜体</a></li>
<li><a href="#1.4">1.4中间划线</a></li>
<li><a href="#1.5">1.5下划线</a></li>
<li><a href="#1.6">1.6分割线</a></li>
<li><a href="#1.7">1.7重点符号</a></li>
<li><a href="#1.8">1.8加个框</a></li>
<li><a href="#1.9">1.9加个x框</a></li>
<li><a href="#1.10">1.10插入表格</a></li>
</ul>
</li>
<li><a href="#2">2.插入html</a><ul>
<li><a href="#2.1">2.1 html插入图片</a></li>
<li><a href="#2.2">2.2 html并排插入图片</a></li>
</ul>
</li>
<li><a href="#3">3.插入link和图片</a></li>
<li><a href="#4">4.插入流程图</a></li>
<li><a href="#5">5.插入公式</a></li>
<li><a href="#6">6.引用</a></li>
<li><a href="#7">7.data files</a></li>
<li><a href="#8">8.插入表格</a></li>
</ul>
<h4 id="1.1"> 1.1 标题 # ## ###</h4><br>### 基本用法<br><h1 id="1.2"> 1.2 变粗 <strong> </strong> </h1><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">利用** 这里是变粗的内容**</span><br></pre></td></tr></table></figure><br><br><strong>变粗</strong><br><h4 id="1.3">1.3 斜体 <em> </em> </h4><br><em>斜体</em><br><br>&gt;<h4 id="1.4">1.4 中间划线 ~~ ~~</h4> 

<p><del>中间划线</del></p>
<h4 id="1.5">1.5 下划线不知道怎么搞</h4><br>下划线 不知道怎么搞 ++我很好++<br>++22222++<br>==这个是区域==<br>==是多少==<br><br><h4 id="1.6">1.6分割线</h4>

<hr>
<h4 id="1.7"> 1.7 重点符号 -</h4>

<ul>
<li>重点符号</li>
<li>一条一条的 </li>
<li></li>
</ul>
<h4 id="1.8"> 1.8 加个框框</h4>

<ul>
<li style="list-style: none"><input type="checkbox"> 重点符号</li>
<li>重点啊</li>
<li style="list-style: none"><input type="checkbox"> 重点符号</li>
</ul>
<h4 id="1.9">1.9 加个x框框 - [x]</h4>

<ul>
<li style="list-style: none"><input type="checkbox" checked> 未完成符号</li>
</ul>
<h4 id="1.10"> 1.10 插入表格</h4>

<table>
<thead>
<tr>
<th>时间</th>
<th>地点</th>
<th>人物</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>
<p></p><h3 id="2.1">2.1 插入html</h3><p></p>
<p><figure class="third"><br>    <img src="/images/cloudy.png"><br>    <img src="/images/cloudy.png"><br></figure><br><img src="https://i.imgur.com/XAQCloy.jpg"></p>
<div align="center"><br>    <img src="/images/cloudy.png" alt="Alt text"><br>    <img src="/images/cloudy.png" alt="Alt text"><br></div>

<h2 id="2-2-并排插入"><a href="#2-2-并排插入" class="headerlink" title="2.2 并排插入"></a><h3 id="2.2">2.2 并排插入</h3></h2><div style="float:left;border:solid 1px 000;margin:2px;"><img src="/images/cloudy.png" width="200" height="260"></div><br><div style="float:left;border:solid 1px 000;margin:2px;"><img src="/images/cloudy.png" width="200" height="60"></div><br><br> <br><br><br> <br><br><br> <br><br>—<br><br><h4 id="3"> 3.插入link 和 图片</h4><br>插入链接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">插入链接</span><br><span class="line">[link](https://note.youdao.com/)</span><br><span class="line">插入图片</span><br><span class="line">![点击跳转](/images/cloudy.png &quot;hexo 网站&quot;)</span><br><span class="line">直接跳转</span><br><span class="line">&lt;a href=&quot;/Main&quot;&gt; 你在哪里&lt;/a&gt;</span><br><span class="line">代码插入图片</span><br><span class="line">&lt;a href=&quot;www.baidu.com&quot;&gt;</span><br><span class="line">    &lt;img src=&quot;/images/cloudy.png&quot;&gt;</span><br><span class="line">&lt;/a&gt;</span><br></pre></td></tr></table></figure><br><br><a href="https://note.youdao.com/" target="_blank" rel="noopener">link</a><br>插入图片<br><img src="/images/cloudy.png" alt="点击跳转" title="hexo 网站"><br><br><a href="www.baidu.com"><br>    <img src="/images/cloudy.png"><br></a><br><br>### 直接跳转<br><a href="/Main"> 你在哪里</a><br><br><h3 id>4 插入流程图</h3><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-filter-flowchart</span><br></pre></td></tr></table></figure><br><br><div id="flowchart-0" class="flow-chart"></div>

<h1 id="5-插入公式"><a href="#5-插入公式" class="headerlink" title="5 插入公式"></a>5 插入公式</h1><h1 id="6-引用"><a href="#6-引用" class="headerlink" title="6 引用"></a>6 引用</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">插入引用</span><br><span class="line">&#123;% youtube hY7M5jjJ9mM %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% blockquote %&#125;</span><br><span class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque hendrerit lacus ut purus iaculis feugiat. Sed nec tempor elit, quis aliquam neque. Curabitur sed diam eget dolor fermentum semper at eu lorem.</span><br><span class="line">&#123;% endblockquote %&#125;</span><br></pre></td></tr></table></figure>
<div class="video-container"><iframe src="//www.youtube.com/embed/hY7M5jjJ9mM" frameborder="0" allowfullscreen></iframe></div>
<blockquote><br>  adsfadsfasdfasdf<br></blockquote>

<blockquote><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque hendrerit lacus ut purus iaculis feugiat. Sed nec tempor elit, quis aliquam neque. Curabitur sed diam eget dolor fermentum semper at eu lorem.</p>
</blockquote>
<h2 id="quote-from-an-article-on-the-web"><a href="#quote-from-an-article-on-the-web" class="headerlink" title="quote from an article on the web"></a>quote from an article on the web</h2><blockquote><p>Every interaction is both precious and an opportunity to delight.</p>
<footer><strong>Seth Godin</strong><cite><a href="http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html" target="_blank" rel="noopener">Welcome to Island Marketing</a></cite></footer></blockquote>
<h1 id="7-data-files"><a href="#7-data-files" class="headerlink" title="7 data files"></a>7 data files</h1><p>&lt;% for (var link in site.data.menu) { %&gt;<br>    <a href="<%= site.data.menu[link]%>">   &lt;%= link %&gt; </a><br>&lt;% } %&gt;</p>
<p><script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">st=>start: Start|past:>http://www.google.com[blank]
e=>end: End:>http://www.google.com
op1=>operation: My Operation|past
op2=>operation: Stuff|current
sub1=>subroutine: My Subroutine|invalid
cond=>condition: Yes
or No?|approved:>http://www.google.com
c2=>condition: Good idea|rejected
io=>inputoutput: catch something...|request

st->op1(right)->cond
cond(yes, right)->c2
cond(no)->sub1(left)->op1
c2(yes)->io->e
c2(no)->op2->e</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/02/25/unity-shader-alpha/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/25/unity-shader-alpha/" itemprop="url">unity shader 透明效果</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-25T17:18:03+08:00">
                2019-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>实时渲染要实现透明效果，需要在渲染模型时控制它的透明通道，alpha channel<br>通常使用两种方法来实现透明效果：</p>
<h5 id="透明度测试-alpha-test"><a href="#透明度测试-alpha-test" class="headerlink" title="透明度测试 alpha test"></a>透明度测试 alpha test</h5><p>只要一个片元的透明度不满足条件(通常是小于某个阈值)，那么它对应的片元就会被舍弃，被舍弃的片元将不会再进行任何处理，也不会对颜色缓冲产生任何影响，否则就按普通不透明物体的处理方式处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void clip(float4 x)</span><br><span class="line">&#123;</span><br><span class="line">    if(any ( x &lt; 0))</span><br><span class="line">        discard;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;My/AlphaTest&quot;&#123;</span><br><span class="line">    Properties&#123;</span><br><span class="line">        _Color(&quot;Main Tint&quot;, Color) = (1,1,1,1)</span><br><span class="line">        _MainTex(&quot;MainTex&quot;, 2D) = &quot;white&quot; ()</span><br><span class="line">        _CutOff(&quot;Alpha CutOff&quot;, Range(0, 1)) = 0.5</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader&#123;</span><br><span class="line">        Tags&#123;&quot;queue&quot;=&quot;AlphaTest&quot; &quot;IgnoreProjector&quot;=&quot;True&quot; &quot;RenderType&quot;=&quot;TransparentCutOut&quot;&#125;</span><br><span class="line">        Pass&#123;</span><br><span class="line">            Tags&#123;&quot;LightMode&quot;=&quot;ForwardBase&quot;&#125;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line">            #include &quot;Lighting.cginc&quot;</span><br><span class="line">           	</span><br><span class="line">            fixed4 _Color;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            float4 _MainTex_ST;</span><br><span class="line">            fixed _CutOff;</span><br><span class="line">            </span><br><span class="line">             struct a2v&#123;</span><br><span class="line">                float4 vertex   : POSITION;</span><br><span class="line">                float3 normal   : NORMAL;</span><br><span class="line">                float4 texcoord : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            struct v2f&#123;</span><br><span class="line">                float4 pos  		:  SV_POSITION;</span><br><span class="line">                float3 worldNormal  :  TEXCOORD0;</span><br><span class="line">                float3 worldPos     :  TEXCOORD1;</span><br><span class="line">                float2 uv			:  TEXCOORD2;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            v2f vert(a2v v)&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos         = mul(UNITY_MATRIX_MVP, v.vertex);</span><br><span class="line">                o.worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line">                o.worldPos    = mul(_Object2World, v.vertex).xyz;</span><br><span class="line">                o.uv          = TRANSFORM_TEX(v.texcoord, _MainTex);</span><br><span class="line">                return o;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            fixed4 frag(v2f i) : SV_Target&#123;</span><br><span class="line">                fixed3 worldNormal   = normalize(i.worldNormal);</span><br><span class="line">                fixed3 worldLightDir = normalize(UnityWorldSpaceLightDir(i.worldPos));</span><br><span class="line">                fixed4 texColor      = tex2D(_MainTex, i.uv);</span><br><span class="line">                clip(texColor.a - _Cutoff);</span><br><span class="line">                fixed3 albedo = texColor.rgb * _Color.rgb;</span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz * albedo;</span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * albedo * max(0, dot(worldNormal, worldLightDir));</span><br><span class="line">                return fixed4(ambient + diffuse, 1.0);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Fallback &quot;VertexLit&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="透明度混合alpha-blending"><a href="#透明度混合alpha-blending" class="headerlink" title="透明度混合alpha blending"></a>透明度混合alpha blending</h5><h5 id="深度缓冲-z-buffer"><a href="#深度缓冲-z-buffer" class="headerlink" title="深度缓冲 z-buffer"></a>深度缓冲 z-buffer</h5><h5 id="渲染队列-render-queue"><a href="#渲染队列-render-queue" class="headerlink" title="渲染队列 render queue"></a>渲染队列 render queue</h5><h5 id="双面渲染原理"><a href="#双面渲染原理" class="headerlink" title="双面渲染原理"></a>双面渲染原理</h5><p>把双面渲染工作分成两个Pass：第一个pass只渲染背面，第二个pass只渲染正面，由于Unity会顺序执行Subshader中的各个Pass，因此我们可以保证背面总是在正面被渲染之前渲染，从而保证正确的深度渲染关系。</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><ul>
<li>一共有两种方式可以实现，一个是控制透明度测试alphaTest 小于某个值就舍弃，简单粗暴，开启深度写入。</li>
<li>透明度混合，可以有两个通道第一个把背面的渲染出来，第二个把正面渲染出来 然后颜色混合,需要关闭深度写入</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/02/25/unity-shader-mask/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/25/unity-shader-mask/" itemprop="url">unity 遮罩纹理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-25T15:59:58+08:00">
                2019-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="遮罩纹理"><a href="#遮罩纹理" class="headerlink" title="遮罩纹理"></a>遮罩纹理</h5><p>通过采样得到纹理的纹理像素值，然后使用其中某个或者某几个通道的值来与某种表面属性进行相乘，这样当该通道的值为0时，可以保护表面不受该属性的影响。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;My/Mask&quot;&#123;</span><br><span class="line">    properties&#123;</span><br><span class="line">     	_Color(&quot;Color&quot;, Color)           	= (1,1,1,1)</span><br><span class="line">        _MainTex(&quot;MainTex&quot;, 2D)          	= &quot;white&quot;&#123;&#125;</span><br><span class="line">        _BumpMap(&quot;Normal Map&quot;, 2D)       	= &quot;bump&quot; &#123;&#125;</span><br><span class="line">        _BumpScale(&quot;Bump Scale&quot;, Float)  	= 1.0</span><br><span class="line">		_Specular(&quot;Specular&quot;, Color)     	= (1,1,1,1)</span><br><span class="line">        _SpecularScale(&quot;Specular Scale&quot;, Float) = 1.0</span><br><span class="line">        _SpecularMask(&quot;Specular Mask&quot;, 2D)  = &quot;white&quot; &#123;&#125;</span><br><span class="line">        _Gloss(&quot;Gloss&quot;, Range(8.0, 256)) = 20</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    SubShader&#123;</span><br><span class="line">        Pass&#123;</span><br><span class="line">            Tags&#123;&quot;LightMode&quot;=&quot;ForwardBase&quot;&#125;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line">            #include &quot;Lighting.cginc&quot;</span><br><span class="line">            fixed4 _Color;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            float4 _MainTex_ST;</span><br><span class="line">            sampler2D _BumpMap;</span><br><span class="line">            sampler2D _SpecularMask;</span><br><span class="line">            float _SpecularScale;</span><br><span class="line">            fixed4 _Specular;</span><br><span class="line">            float _Gloss;</span><br><span class="line">            </span><br><span class="line">            struct a2v&#123;</span><br><span class="line">                float4 vertex 		: POSITION;</span><br><span class="line">                float3 normal		: NORMAL;</span><br><span class="line">                float4 tangent      : TANGENT;</span><br><span class="line">                float4 texcoord		: TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            struct v2f&#123;</span><br><span class="line">                float4 pos 		: SV_POSITION;</span><br><span class="line">                float2 uv	    : TEXCOORD0;</span><br><span class="line">                float3 lightDir : TEXCOORD1;</span><br><span class="line">                float3 viewDir  : TEXCOORD2;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            v2f vert(a2v v)&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos 		= mul(UNITY_MATRIX_MVP, v.vertex);</span><br><span class="line">                o.uv.xy		= v.texcoord.xy * _MainTex_ST.xy + _MainTex_ST.zw;</span><br><span class="line">                TANGENT_SPACE_ROTATION;</span><br><span class="line">                o.lightDir = mul(rotation, ObjSpaceLightDir(v.vertex)).xyz;</span><br><span class="line">                o.viewDir  = mul(rotation, ObjSpaceViewDir(v.vertex)).xyz;</span><br><span class="line">                return o;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            fixed4 frag(v2f i) : SV_Target&#123;</span><br><span class="line">                fixed3 tangentLightDir = normalize(i.lightDir);</span><br><span class="line">                fixed3 tangentViewDir  = normalize(i.viewDir);</span><br><span class="line">                fixed3 tangentNormal   = UnpackNormal(tex2D(_BumpMap, i.uv));</span><br><span class="line">                tangentNormal.xy *= _BumpScale;</span><br><span class="line">                tangentNormal.z = sqrt(1 - saturate(dot(tangentNormal.xy, tangentNormal.xy)));</span><br><span class="line">                fixed3 albedo  = tex2D(_MainTex, i.uv).rgb  * _Color.rgb;</span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz * albedo;</span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * albedo * max(0, dot(tangentNormal, tangentLightDir));</span><br><span class="line">                fixed3 halfDir = normalize(tangentLightDir + tangentViewDir);</span><br><span class="line">                fixed  specularMask = tex2D(_SpecularMask, i.uv).r * _SpecularScale;</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * pow(max(0, dot(tangentNormal, halfDir)) ,_Gloss) * specularMask;</span><br><span class="line">                return fixed4(ambient + diffuse + specular, 1.0);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/02/25/unity-shader-ramp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/25/unity-shader-ramp/" itemprop="url">unity 渐变纹理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-25T15:07:47+08:00">
                2019-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>纹理可以存储任何表面属性，一种常见的办法就是使用渐变纹理来控制漫反射光照的颜色。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">"My/RampTexture"</span>&#123;</span><br><span class="line">    Properties&#123;</span><br><span class="line">		_Color(<span class="string">"Color Tint"</span>, Color) = (<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">        _RampTex(<span class="string">"Ramp Tex"</span>, <span class="number">2</span>D) = <span class="string">"white"</span> &#123;&#125;</span><br><span class="line">        _Specular(<span class="string">"Specular"</span>, Color) = (<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">        _Gloss(<span class="string">"Gloss"</span>, Range(<span class="number">8</span>, <span class="number">256</span>)) = <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    SubShader&#123;</span><br><span class="line">        Pass&#123;</span><br><span class="line">            Tags&#123;<span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span>&#125;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">                #pragma vertex vert</span><br><span class="line">                #pragma fragment frag</span><br><span class="line">                #include <span class="string">"Lighting.cginc"</span></span><br><span class="line">                fixed4 _Color;</span><br><span class="line">            	sampler2D _RampTex;</span><br><span class="line">            	float4 _RampTex_ST;</span><br><span class="line">            	fixed4 _Specular;</span><br><span class="line">            	<span class="keyword">float</span>  _Gloss;</span><br><span class="line">            	</span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">a2v</span>&#123;</span></span><br><span class="line">                float4 vertex      : POSITION;</span><br><span class="line">                float3 normal      : NORMAL;</span><br><span class="line">                float4 texcoord    : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">v2f</span>&#123;</span></span><br><span class="line">              float4 pos          : SV_POSITION;</span><br><span class="line">              float3 worldNormal  : TEXCOORD0;</span><br><span class="line">              float3 worldPos	  : TEXCOORD1;</span><br><span class="line">              float2 uv			  : TEXCOORD2;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="function">v2f <span class="title">vert</span><span class="params">(a2v v)</span></span>&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = mul(UNITY_MATRIX_MVP, v.vertex);</span><br><span class="line">                o.worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line">                o.worldPos = mul(_Object2World, v.vertex).xyz;</span><br><span class="line">                o.uv = TRANSFORM_TEX(v.texcoord, _RampTex);</span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            fixed4 frag(v2f i) : SV_Target&#123;</span><br><span class="line">                fixed3 worldNormal = normalize(i.worldNormal);</span><br><span class="line">                fixed3 worldLightDir    = normalize(UnityWorldSpaceLightDir(i.worldPos));</span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz;</span><br><span class="line">                fixed3 halfLambert = <span class="number">0.5</span>* dot(worldNormal, worldLightDir) + <span class="number">0.5</span>;</span><br><span class="line">                fixed3 diffuseColor = tex2D(_RampTex, fixed2(halfLambert, halfLambert)).rgb * _Color.rgb;  <span class="comment">//使用半兰伯特模型来构建一个纹理坐标，并用这个坐标对渐变纹理采样</span></span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * diffuseColor;</span><br><span class="line">                fixed3 viewDir = normalize(UnityWorldSpaceViewDir(i.worldPos));</span><br><span class="line">                fixed3 halfDir = normalize(worldLightDir + viewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * <span class="built_in">pow</span>(max(<span class="number">0</span>, dot(worldNormal, halfDir)) ,_Gloss);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> fixed4(ambient + diffuse + specular, <span class="number">1.0</span>);</span><br><span class="line">            </span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Fallback <span class="string">"Specular"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/02/25/unity-shader-bump/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/25/unity-shader-bump/" itemprop="url">unity 凹凸映射</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-25T09:46:57+08:00">
                2019-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="凹凸映射"><a href="#凹凸映射" class="headerlink" title="凹凸映射"></a>凹凸映射</h5><p>凹凸映射的目的是使用一张纹理来修改模型表面的法线，让模型看起来凹凸不平。</p>
<h5 id="高度纹理"><a href="#高度纹理" class="headerlink" title="高度纹理"></a>高度纹理</h5><p>存储的是强度值，它用于表示模型表面局部的海拔高度，颜色越浅表明该位置的表面越向外凸起，颜色越深表明该位置越向里凹，可以很直观的从高度图里明确的知道一个模型表面的凹凸情况。缺点是计算更加复杂，在实时计算中不能直接得到表面法线，而需要由像素的灰度值计算而得，需要消耗很多性能。</p>
<p>#####法线纹理</p>
<p>存储的是表面的法线方向，由于法线方向的分量范围在[-1, 1],而像素的分布范围是[0,1]因此需要做一个映射，pixel=（normal + 1)/2 反映射的过程就是norma=pixel x 2 - 1</p>
<h5 id="模型空间的法线纹理"><a href="#模型空间的法线纹理" class="headerlink" title="模型空间的法线纹理"></a>模型空间的法线纹理</h5><p>修改后的模型空间中的表面法线存储在一张纹理中，按照模型自带的坐标空间，模型空间<br>由于每个点存储的法线方向是各异的，所以看起来是<strong>五颜六色</strong>的。<br>优点：</p>
<ul>
<li>实现简单，更加直观</li>
<li>在纹理坐标的缝合处和尖锐的边角部分，可见的缝隙较少，可以提供平滑的边界</li>
</ul>
<h5 id="切线空间的法线纹理"><a href="#切线空间的法线纹理" class="headerlink" title="切线空间的法线纹理"></a>切线空间的法线纹理</h5><p>对于模型的每一个顶点，它都有一个属于自己的切线空间，这个切线空间的原点就是该顶点本身，z轴是顶点的法线方向(n), x轴是顶点的切线方向(t)，y轴可由法线和切线叉乘得到，也被称为副切线b。<br>切线空间下的法线纹理看起来几乎都是浅蓝色的，纹理其实是存储了各自的切线空间中的法线扰动方向。如果一个点的法线方向不变，那么在它的切线空间中，新的法线方向就是z轴方向(0,0,1)经过映射后存储在纹理中RGB(0.5,0.5,1)为浅蓝色。所以切线空间下的法线纹理看起来是一大片<strong>浅蓝色</strong>的</p>
<p>优点：</p>
<ul>
<li>自由度高。可以用在别的网格中。</li>
<li>可以进行UV动画。可以移动一个纹理的UV坐标来实现一个凹凸移动的效果</li>
<li>可以重用法线纹理。比如一个砖块可以用一张法线纹理就可以用到所有的6个面上</li>
<li>可压缩。z总是法线方向，因此可以只存储xy方向的值。</li>
</ul>
<p>#####Shader实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;My/bump&quot;&#123;</span><br><span class="line">    Properties&#123;</span><br><span class="line">    	_Color(&quot;Color&quot;, Color)           = (1,1,1,1)</span><br><span class="line">        _MainTex(&quot;MainTex&quot;, 2D)          = &quot;white&quot;&#123;&#125;</span><br><span class="line">        _BumpMap(&quot;Normal Map&quot;, 2D)       = &quot;bump&quot; &#123;&#125;</span><br><span class="line">        _BumpScale(&quot;Bump Scale&quot;, Float)  = 1.0</span><br><span class="line">		_Specular(&quot;Specular&quot;, Color)     = (1,1,1,1)</span><br><span class="line">        _Gloss(&quot;Gloss&quot;, Range(8.0, 256)) = 20</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    SubShader&#123;</span><br><span class="line">        Pass&#123;</span><br><span class="line">            Tag &#123; &quot;LightMode&quot;=&quot;ForwardBase&quot; &#125;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line">            #include &quot;Lighting.cginc&quot;</span><br><span class="line">            fixed4 _Color;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            float4 _MainTex_ST;</span><br><span class="line">            sampler2D _BumpMap;</span><br><span class="line">            float4 _BumpMap_ST;</span><br><span class="line">            float  _BumpScale;</span><br><span class="line">            fixed4 _Specular;</span><br><span class="line">            float  _Gloss;</span><br><span class="line">            </span><br><span class="line">            struct a2v&#123;</span><br><span class="line">                float4 vertex 	: POSITION;</span><br><span class="line">                float3 normal 	: NORMAL;</span><br><span class="line">                float4 tagent 	: TANGENT; //xyzw w来确定第三个坐标轴的副切线方向性</span><br><span class="line">                float4 texcoord : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            struct v2f&#123;</span><br><span class="line">            	float4 pos  : SV_POSITION;</span><br><span class="line">                float4 uv   : TEXCOORD0;</span><br><span class="line">                float3 lightDir : TEXCOORD1;</span><br><span class="line">                float3 viewDir  : TEXCOORD2;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            v2f vert(a2v v)&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = mul(UNITY_MATRIX_MVP, v.vertex);</span><br><span class="line">                o.uv.xy = v.texcoord.xy * _MainTex_ST.xy + _MainTex_ST.zw;</span><br><span class="line">                o.uv.zw = v.texcoord.xy * _BumpMap_ST.xy + _BumpMap_ST.zw;</span><br><span class="line">                //转换到切线空间</span><br><span class="line">                TANGENT_SPACE_ROTATION;</span><br><span class="line">                o.lightDir = mul(rotation, ObjSpaceLightDir(v.vertex)).xyz;</span><br><span class="line">                o.viewDir = mul(rotation, ObjSpaceViewDir(v.vertex)).xyz;</span><br><span class="line">                return o;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            fixed4 frag(v2f i) : SV_Target&#123;</span><br><span class="line">                fixed3 tangentLightDir = normalize(i.lightDir);</span><br><span class="line">                fixed3 tagentViewDir   = normalize(i.viewDir);</span><br><span class="line">                </span><br><span class="line">                fixed4 packedNormal = tex2D(_BumpMap, i.uv.zw); //得到的是压缩过的法线</span><br><span class="line">                fixed3 tangentNormal;</span><br><span class="line">                tangentNormal = UnpackNormal(packedNormal);     //得到正确的法线</span><br><span class="line">                tangentNormal.xy *= _BumpScale;</span><br><span class="line">                tangentNormal.z = sqrt(1 - saturate(dot(tangentNormal.xy, 	tangentNormal.xy)));</span><br><span class="line">                fixed3 albedo = tex2D(_MainTex, i.uv).rgb * _Color.rgb;</span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz * albedo;</span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * albedo * max(0, dot(tangentNormal, tangentLightDir));</span><br><span class="line">                fixed3 halfDir = normalize(tangentLightDir + tangentViewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * pow(max(0, dot(tangentNormal, halfDir)), _Gloss);</span><br><span class="line">                return fixed4(ambient + diffuse + specular, 1.0);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    FallBack &quot;diffuse&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>世界空间下计算光照模型；需要在片元着色器中把法线方向从切线空间变换到世界空间下。<br>在顶点着色器计算从切线空间到世界空间的变换矩阵，并把它传递给片元着色器。变换矩阵的计算可以由顶点的切线、副切线和法线在世界空间下的表示来得到，最后在片元着色器中把法线纹理中的法线方向从切线空间变换到世界空间。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;My/NormalMapWorldSpace&quot;&#123;</span><br><span class="line">    Properties&#123;</span><br><span class="line">    	_Color(&quot;Color&quot;, Color)           = (1,1,1,1)</span><br><span class="line">        _MainTex(&quot;MainTex&quot;, 2D)          = &quot;white&quot;&#123;&#125;</span><br><span class="line">        _BumpMap(&quot;Normal Map&quot;, 2D)       = &quot;bump&quot; &#123;&#125;</span><br><span class="line">        _BumpScale(&quot;Bump Scale&quot;, Float)  = 1.0</span><br><span class="line">		_Specular(&quot;Specular&quot;, Color)     = (1,1,1,1)</span><br><span class="line">        _Gloss(&quot;Gloss&quot;, Range(8.0, 256)) = 20</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    SubShader&#123;</span><br><span class="line">        Pass&#123;</span><br><span class="line">            Tag &#123; &quot;LightMode&quot;=&quot;ForwardBase&quot; &#125;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            #pragma vertex vert</span><br><span class="line">            #pragma fragment frag</span><br><span class="line">            #include &quot;Lighting.cginc&quot;</span><br><span class="line">            fixed4 _Color;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            float4 _MainTex_ST;</span><br><span class="line">            sampler2D _BumpMap;</span><br><span class="line">            float4 _BumpMap_ST;</span><br><span class="line">            float  _BumpScale;</span><br><span class="line">            fixed4 _Specular;</span><br><span class="line">            float  _Gloss;</span><br><span class="line">            </span><br><span class="line">            struct a2v&#123;</span><br><span class="line">                float4 vertex 	: POSITION;</span><br><span class="line">                float3 normal 	: NORMAL;</span><br><span class="line">                float4 tagent 	: TANGENT; //xyzw w来确定第三个坐标轴的副切线方向性</span><br><span class="line">                float4 texcoord : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            struct v2f&#123;</span><br><span class="line">            	float4 pos   : SV_POSITION;</span><br><span class="line">                float4 uv    : TEXCOORD0;</span><br><span class="line">               	float4 TtoW0 : TEXCOORD1;</span><br><span class="line">                float4 TtoW1 : TEXCOORD2;</span><br><span class="line">                float4 TtoW2 : TEXCOORD3;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            v2f vert(a2v v)&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = mul(UNITY_MATRIX_MVP, v.vertex);  //剪裁空间</span><br><span class="line">                o.uv.xy = v.texcoord.xy * _MainTex_ST.xy + _MainTex_ST.zw;</span><br><span class="line">                o.uv.zw = v.texcoord.xy * _BumpMap_ST.xy + _BumpMap_ST.zw;</span><br><span class="line">         		float3 worldPos = mul(_Object2World, v.vertex).xyz;</span><br><span class="line">                fixed3 worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line">                fixed3 worldTangent = UnityObjectToWolrdDir(v.tangent.xyz);</span><br><span class="line">                fixed3 worldBinormal = cross(worldNormal, worldTagent) * v.tangent.w;</span><br><span class="line">                </span><br><span class="line">                o.TtoW0 = float4(worldTangent.x, worldBinormal.x, worldNormal.x, worldPos.x);</span><br><span class="line">                o.TtoW1 = float4(worldTangent.y, worldBinormal.y, worldNormal.y, worldPos.y);</span><br><span class="line">                o.TtoW2 = float4(worldTangent.z, worldBinormal.z, worldNormal.z, worldPos.z);</span><br><span class="line">                return o;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            fixed4 frag(v2f i) : SV_Target&#123;</span><br><span class="line">              	//得到顶点的世界坐标</span><br><span class="line">       			float3 worldPos = float3(i.TtoW0.w, i.TtoW1.w, i.TtoW2.w);</span><br><span class="line">                fixed3 lightDir = normalize(UnityWorldSpaceLightDir(worldPos));</span><br><span class="line">                fixed3 viewDir  = normalize(UnityWorldSpaceViewDir(worldPos));</span><br><span class="line">                </span><br><span class="line">                //得到切线空间的法线</span><br><span class="line">                fixed3 bump = UnpackNormal(tex2D(_BumpMap, i.uv.zw));</span><br><span class="line">                bump.xy *= _BumpScale;</span><br><span class="line">                bump.z = sqrt(1 - saturate(dot(bump.xy, bump.xy)));</span><br><span class="line">                bump = normalize(half3(dot(i.TtoW0.xyz, bump), dot(i.TtoW1.xyz, bump), dot(i.TtoW2.xyz, bump)));</span><br><span class="line">                fixed3 albedo = tex2D(_MainTex, i.uv).rgb * _Color.rgb;</span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz * albedo;</span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * albedo * max(0, dot(bump, lightDir));</span><br><span class="line">                fixed3 halfDir = normalize(lightDir + viewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * pow(max(0, dot(bump, halfDir)), _Gloss);</span><br><span class="line">                return fixed4(ambient + diffuse + specular, 1.0);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    FallBack &quot;diffuse&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/02/22/unity-shader-texture/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/22/unity-shader-texture/" itemprop="url">unity-shader-texture</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-22T11:13:51+08:00">
                2019-02-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="纹理采样"><a href="#纹理采样" class="headerlink" title="纹理采样"></a>纹理采样</h5><p>纹理名_ST，其中ST是缩放scale和平移translation的缩写。<br>_MainTex_ST可以让我们得到该纹理的缩放和平移(偏移)值。<br>_MainTex_ST.xy存储的是缩放值， _MainTex_ST.zw存储的是偏移值。<br>在unity中可以在材质面板中调节纹理的平铺tiling(缩放)和偏移offset{平移}<br>TRANSFORM_TEX将会根据纹理计算变换后的纹理坐标<br>tex2D函数进行纹理采样</p>
<p>#####纹理的属性</p>
<p>属性调整面板设置纹理类型 wrap mode repeat和clamp </p>
<h5 id="滤波模式FilterMode"><a href="#滤波模式FilterMode" class="headerlink" title="滤波模式FilterMode"></a>滤波模式FilterMode</h5><p>支持三种模式Point Bilinear Trilinear得到的图片滤波效果依次提升，性能消耗越大，会影响<br>放大或缩小时得到的图片质量。比如把64x64纹理贴在512x512大小平面时，需要放大纹理。</p>
<ol>
<li>Point模式使用最近邻滤波nearest neighbor，在放大或者缩小时，它的采样像素数目通常只有一个</li>
<li>Bilinear滤波使用了线性滤波，对于每个目标像素，它会找到四个邻近像素，然后进行线性插值混合后得到最终像素，因此图像看起来模糊了</li>
<li>Trilinear</li>
</ol>
<h5 id="放大纹理"><a href="#放大纹理" class="headerlink" title="放大纹理"></a>放大纹理</h5><h5 id="缩小纹理"><a href="#缩小纹理" class="headerlink" title="缩小纹理"></a>缩小纹理</h5><h5 id="多级渐远纹理mipmapping"><a href="#多级渐远纹理mipmapping" class="headerlink" title="多级渐远纹理mipmapping"></a>多级渐远纹理mipmapping</h5><p>在一个很小空间里有很多东西。是提前用滤波处理得到很多更小的图像，随着远离摄像机，使用较小的纹理。这样可以通过增加空间提高性能。如果在导入纹理时设置了这个GenerateMipMaps，将会生成多级渐远纹理。</p>
<h5 id="Shader示例"><a href="#Shader示例" class="headerlink" title="Shader示例"></a>Shader示例</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//普通纹理采样</span></span><br><span class="line">Shader <span class="string">"shader/texture"</span>&#123;</span><br><span class="line">    Properties&#123;</span><br><span class="line">        _MainTex(<span class="string">"MainTex"</span>, <span class="number">2</span>D) = <span class="string">"white"</span>&#123;&#125;</span><br><span class="line">        _Color(<span class="string">"MainColor"</span>, Color)  = (<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">        _Specular(<span class="string">"Specular"</span>, Color) =(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">        _Gloss(<span class="string">"Gloss"</span>, Range(<span class="number">8</span>,<span class="number">256</span>)) = <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">    SubShader&#123;</span><br><span class="line">        Pass&#123;</span><br><span class="line">            Tags &#123;<span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span>&#125;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">                #pragma vertex vert</span><br><span class="line">                #pragma fragment frag</span><br><span class="line">                #include <span class="string">"Lighting.cginc"</span></span><br><span class="line">                </span><br><span class="line">                fixed4    _Color;</span><br><span class="line">            	sampler2D _MainTex;</span><br><span class="line">            	fixed4	  _Specular;</span><br><span class="line">            	<span class="keyword">float</span>     _Gloss;</span><br><span class="line">            	float4    _MainTex_ST;</span><br><span class="line">            </span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">a2v</span> &#123;</span></span><br><span class="line">                float4 vertex      : POSITION;</span><br><span class="line">                float3 normal      : NORMAL;</span><br><span class="line">                float4 texcoord    : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">v2f</span>&#123;</span></span><br><span class="line">            	float4 pos 		   : SV_POSITION;</span><br><span class="line">                float3 worldNormal : TEXCOORD0;</span><br><span class="line">                float3 worldPos    : TEXCOORD1;</span><br><span class="line">                float4 uv		   : TEXCOORD2;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="function">v2f <span class="title">vert</span><span class="params">(a2v v)</span></span>&#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.pos = mul(UNITY_MATRIX_MVP, v.vertex);</span><br><span class="line">                o.worldNormal = UnityObjectToWorldNormal(v.normal);</span><br><span class="line">                o.worldPos = mul(_Object2World, v.vertex).xyz;</span><br><span class="line">                o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);</span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            float4 frag(v2f i) : SV_Target</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//归一化</span></span><br><span class="line">                fixed3  worldNormal = normalize(i.worldNormal);</span><br><span class="line">                fixed3  worldLightDir = normalize(UnityWorldLightDir(i.worldPos));</span><br><span class="line">                <span class="comment">//</span></span><br><span class="line">                fixed3 albedo = tex2D(_MainTex, i.uv).rgb * _Color.rgb;</span><br><span class="line">                fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz * albedo;</span><br><span class="line">                fixed3 diffuse = _LightColor0.rgb * albedo * max(<span class="number">0</span>, dot(worldNormal, worldLightDir));</span><br><span class="line">                fixed3 viewDir = normalize(UnityWorldSpaceViewDir(i.worldPos));</span><br><span class="line">                fixed3 halfDir = normalize(worldLightDir + viewDir);</span><br><span class="line">                fixed3 specular = _LightColor0.rgb * _Specular.rgb * <span class="built_in">pow</span>(max(<span class="number">0</span>,dot(worldNormal, halfDir)), _Gloss);</span><br><span class="line">                <span class="keyword">return</span> fixed4(ambient + diffuse + specular, <span class="number">1.0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            CGEND</span><br><span class="line">        &#125;</span><br><span class="line">        FallBack <span class="string">"Specular"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/02/21/unity-light-mode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/21/unity-light-mode/" itemprop="url">光 光照模型 漫反射</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-21T11:07:15+08:00">
                2019-02-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[TOC]</p>
<h4 id="光"><a href="#光" class="headerlink" title="光"></a>光</h4><ol>
<li>方向 l表示方式</li>
<li>辐射度 irradiance, 垂直于l的单位面积上单位时间内穿过的能量就是辐射度</li>
<li>颜色</li>
</ol>
<h5 id="吸收absorption"><a href="#吸收absorption" class="headerlink" title="吸收absorption"></a>吸收absorption</h5><p>不改变 方向<br>改变 光的密度和颜色</p>
<h5 id="散射scattering"><a href="#散射scattering" class="headerlink" title="散射scattering"></a>散射scattering</h5><p>改变光的方向<br>不改变光的颜色和密度</p>
<ol>
<li>折射 refraction(透射transmission)     通过漫反射diffuse来模拟，有多少光线被折射、吸收、和散射出表面</li>
<li>反射 reflection                                      通过高光反射来反应模拟specular</li>
</ol>
<h5 id="出射度"><a href="#出射度" class="headerlink" title="出射度"></a>出射度</h5><p>辐射度和出射度之间满足一定线性关系，这个比值就是材质的漫反射和高光反射属性</p>
<h4 id="标准光照模型"><a href="#标准光照模型" class="headerlink" title="标准光照模型"></a>标准光照模型</h4><p>通常光有以下四部分组成</p>
<ol>
<li>自发光emissive  $c_{emissive}$  直接用了该材质的颜色 $c_{missive}=m_{emissive}$  </li>
<li>高光反射specular $c_{specular}​$</li>
<li>漫反射diffuse $c_{diffuse}$ 是那些被物体表面随机散射到各个方向的辐射度，各个位置都有完全随机，用兰伯特定律来模拟：反射光线的强度和表面法线和光源方向之间的夹角的余弦值成正比$c_{diffuse}=(c_{light}·m_{diffuse})max(0,n·I)$ n为表面法线，I是指向光源的单位矢量，m_diffuse漫反射颜色，c_light光源颜色</li>
<li>环境光ambient  $c_{ambient}$  近似模拟间接光照  $c_{ambient}=g_{ambient}$ 内置变量UNITY_LIGHTMODEL_AMBIENT可以得到环境光的颜色和强度信息</li>
</ol>
<h5 id="Phong模型泊松模型"><a href="#Phong模型泊松模型" class="headerlink" title="Phong模型泊松模型"></a>Phong模型泊松模型</h5><ol>
<li><p>表面法线 n</p>
</li>
<li><p>入射角 I</p>
</li>
<li><p>反射角 r</p>
</li>
<li><p>视角方向 v</p>
</li>
</ol>
<p>这是模型基础，只要知道一个就可以求得其他a·b=|a||b|cosa</p>
<p>r+I=2n(n·I) 所以r=2n(n·I)-I  </p>
<p>泊松模型 :</p>
<p>$C_{specular} = C_{light}m_{specular}max(0, v·r)^{m_{gloss}}​$</p>
<p>其中m_gloss为光泽度也被成为反光度，用于控制高光区域的亮点，m_gloss越大，亮点越小<br>m_specular是材质的高光反射颜色用于控制该材质对于高光反射的强度和颜色<br>c_light是光源的颜色和强度</p>
<h5 id="Blinn模型"><a href="#Blinn模型" class="headerlink" title="Blinn模型"></a>Blinn模型</h5><p>思路是避免求反射角引入 视角和入射角相加再归一化h=(v+I)/|v+i|,然后使用n和h的夹角来计算高光<br>$C_{specular} = C_{light}m_{specular}max(0, v·h)^{m_{gloss}}$</p>
<h5 id="半兰伯特模型"><a href="#半兰伯特模型" class="headerlink" title="半兰伯特模型"></a>半兰伯特模型</h5><p>适用于漫反射光照模型，在平面某点漫反射光的光强与该反射点的法向量和入射光角度的余弦值成正比,这样在光照无法到达的区域，模型的外观通常是全黑的，没有任何明暗变化，是去了模型细节表现，为了改善这种情况，加了两个参数<br>cdiffuse = clight mdiffuse (a(ni) + b), 当a和b都等于0.5时候就是半兰伯特光照模型</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">"My/specular-pixel_level"</span></span><br><span class="line">&#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line">        _Diffuse(<span class="string">"Diffuse"</span>, Color) = (<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">        _Specular(<span class="string">"Specular"</span>, Color) = (<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">        _Gloss(<span class="string">"Gloss"</span>, Range(<span class="number">8</span>,<span class="number">256</span>)) = <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    SubShader&#123;</span><br><span class="line">        Pass&#123;</span><br><span class="line">            Tag&#123;<span class="string">"LightMode"</span>=<span class="string">"ForwardBase"</span>&#125;</span><br><span class="line"></span><br><span class="line">            CGPROGRAM</span><br><span class="line">                <span class="meta">#<span class="meta-keyword">pragma</span> vertex vert</span></span><br><span class="line">                <span class="meta">#<span class="meta-keyword">pragma</span> fragment frag</span></span><br><span class="line"></span><br><span class="line">                <span class="meta">#include "Lighting.cginc"</span></span><br><span class="line"></span><br><span class="line">                fixed4 _Diffuse;</span><br><span class="line">                fixed4 _Specular;</span><br><span class="line">                <span class="keyword">float</span>  _Gloss;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">struct</span> a2v&#123;</span><br><span class="line">                    float4 vertex : POSITION;</span><br><span class="line">                    float3 normal : NORMAL;</span><br><span class="line">                &#125;;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">struct</span> v2f&#123;</span><br><span class="line">                    float4 pos : SV_POSITION;</span><br><span class="line">                    float3 worldNormal : TEXCOORD0;</span><br><span class="line">                    float3 worldPos : TEXCOORD1;</span><br><span class="line">                &#125;;</span><br><span class="line"></span><br><span class="line">                <span class="function">v2f <span class="title">vert</span>(<span class="params">a2v v</span>)</span>&#123;</span><br><span class="line">                    v2f o;</span><br><span class="line">                    o.pos = mul(UNITY_MATRIX_MVP, v.vertex);</span><br><span class="line">                    o.worldNormal = mul(v.normal, _World2Object);</span><br><span class="line">                    o.worldPos = mul(_Object2World, v.vertex).xyz;</span><br><span class="line">                    <span class="keyword">return</span> o;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="function">fixed4 <span class="title">frag</span>(<span class="params">v2f i</span>) : SV_Target</span>&#123;</span><br><span class="line">                                     </span><br><span class="line">                    fixed3 ambient = UNITY_LIGHTMODE_AMBIENT.xyz;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//计算法线</span></span><br><span class="line">                    fixed3 worldNormal = normalize(mul(v.normal, 	(float3x3)_World2Object));</span><br><span class="line">                    fixed3 worldLightDir = normalize(_WorldSpaceLightPos0.xyz);</span><br><span class="line">                    <span class="comment">//计算漫反射</span></span><br><span class="line">                    fixed3 diffuse = _LightColor0.rgb * _Diffuse.rgb * saturate(dot(worldNormal, worldLightDir));</span><br><span class="line">                    <span class="comment">//计算高光反射</span></span><br><span class="line">                    fixed3 reflectDir = normalize(reflect(-WorldLightDir, worldNormal));</span><br><span class="line">                    <span class="comment">//得到观察视角</span></span><br><span class="line">                    fixed3 viewDir = normalize(_WorldSpaceCameraPos.xyz - mul(_Object2World, v.vertex).xyz);</span><br><span class="line">                    fixed3 specular = _LightColor0.rgb * _Specular.rgb * pow(saturate(dot(reflectDir, viewDir)), _Gloss);</span><br><span class="line">                    o.color = ambient + diffuse + specular;</span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">return</span> fixed4(i.color, <span class="number">1.0</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Fallback <span class="string">"specular"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blogs.jiaqiang.fun/2019/02/20/unity-shader-variables/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiaq">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不积跬步无以至千里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/20/unity-shader-variables/" itemprop="url">unity-shader-variables</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-20T14:30:59+08:00">
                2019-02-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Unity-内置的变换矩阵"><a href="#Unity-内置的变换矩阵" class="headerlink" title="Unity 内置的变换矩阵"></a>Unity 内置的变换矩阵</h4><table>
<thead>
<tr>
<th>变量名</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>UNITY_MATRIX_MVP</td>
<td>当前的模型观察投影矩阵，用于将顶点/矢量从模型空间变换到剪裁空间</td>
</tr>
<tr>
<td>UNITY_MATRIX_MV</td>
<td>当前的模型观察投影矩阵，用于将顶点/矢量从模型空间变换观察空间</td>
</tr>
<tr>
<td>UNITY_MATRIX_V</td>
<td>当前的观察矩阵，用于将顶点矢量从世界空间变换到观察空间</td>
</tr>
<tr>
<td>UNITY_MATRIX_P</td>
<td>当前的投影矩阵，用于将顶点矢量从观察空间变换到投影空间</td>
</tr>
<tr>
<td>UNITY_MATRIX_VP</td>
<td>当前的观察投影矩阵用于将顶点矢量从世界空间转换到剪裁空间</td>
</tr>
<tr>
<td>UNITY_MATRIX_T_MV</td>
<td>UNITY_MATRIX_MV的转置矩阵</td>
</tr>
<tr>
<td>UNITY_MATRIX_IT_MV</td>
<td>UNITY_MATRIX_MV的逆转置矩阵，用于将法线从模型空间变换到观察空间，也可以用于得到UNITY_MATRIX_MV的逆矩阵</td>
</tr>
<tr>
<td>_Object2World</td>
<td>当前的模型矩阵，用于将顶点方向矢量从模型空间变换到世界空间</td>
</tr>
<tr>
<td>_World2Object</td>
<td>_Object2World的逆矩阵，用于将顶点方向矢量从世界空间变换到模型空间</td>
</tr>
</tbody>
</table>
<p>​                <strong>unity内置的摄像机和屏幕参数</strong></p>
<table>
<thead>
<tr>
<th>变量名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>_WorldSpaceCameraPos</td>
<td>float3</td>
<td>摄像机在世界空间中的</td>
</tr>
<tr>
<td>unity_CameraProjection</td>
<td>float4x4</td>
<td>摄像机的投影矩阵</td>
</tr>
<tr>
<td>unity_CameraInvProjection</td>
<td>float4x4</td>
<td>摄像机的投影矩阵的逆矩阵</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p><strong>Unity提供的CG/HLSL语义</strong></p>
<h5 id="语义"><a href="#语义" class="headerlink" title="语义"></a>语义</h5><p>语义是CG/HLSL提供的语义semantics，实际上是赋值给shader的一些字符串，这些字符串表达了这个参数的含义，通过这种标记，让shader知道从哪里读取数据，并把数据输出到哪里</p>
<h5 id="系统数值语义-system-value"><a href="#系统数值语义-system-value" class="headerlink" title="系统数值语义 system-value"></a>系统数值语义 system-value</h5><p>例如用SV_POSITION语义去修饰顶点着色器的输出变量pos，那边就表示pos包含了可用于光栅化的变换后的顶点坐标（即齐次剪裁空间中的坐标），用这些语义修饰的变量是不可以随便赋值的，因为流水线需要他们来完成特定的目的，例如渲染引擎会把用SV_POSITION修饰的变量经过光栅化后显示在屏幕上。</p>
<p>#####unity支持的语义</p>
<p>从应用阶段传递模型数据给顶点着色器时unity支持的语义</p>
<table>
<thead>
<tr>
<th>语义</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>POSITION</td>
<td>模型空间的顶点位置，通常是float4类型,</td>
</tr>
<tr>
<td>NORMAL</td>
<td>顶点法线，通常是float3类型</td>
</tr>
<tr>
<td>TANGENT</td>
<td>顶点切线，通常是float4类型</td>
</tr>
<tr>
<td>TEXCOORDn</td>
<td>顶点的纹理坐标，0表示第一组纹理，通常是float2或者float4类型</td>
</tr>
<tr>
<td>COLOR</td>
<td>顶点颜色，通常是fixed4或float4类型</td>
</tr>
</tbody>
</table>
<p>从顶点着色器传递数据给片元着色器时的语义</p>
<table>
<thead>
<tr>
<th>语义</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>SV_POSITION</td>
<td>裁剪空间中的顶点坐标，结构体中必须包含一个用该语义修饰的变量。等同于dx9中的POSITION</td>
</tr>
<tr>
<td>COLOR0</td>
<td>通常用于输出第一组顶点颜色，但不是必需的</td>
</tr>
<tr>
<td>COLOR1</td>
<td>通常用于输出第二组顶点颜色，但不是必需的</td>
</tr>
<tr>
<td>TEXCOORD0~TEXCOORD7</td>
<td>通常用于输出纹理坐标，但不是必需的</td>
</tr>
</tbody>
</table>
<p>从片元着色器输出时支持的语义</p>
<table>
<thead>
<tr>
<th>语义</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>SV_Target</td>
<td>输出值将会存储在渲染目标rendertarget中，等同于dx9的color语义，</td>
</tr>
</tbody>
</table>
<p>定义复杂的变量类型</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">v2f</span>&#123;</span></span><br><span class="line">    float4 pos : SV_POSITION; <span class="comment">//float最高精度浮点值，通常用32位来存储，</span></span><br><span class="line">    fixed3 color0 : COLOR0;   <span class="comment">//fixed最低精度浮点值，通常用11位来存储，范围是-2.0~2.0</span></span><br><span class="line">    fixed4 color1 : COLOR1;</span><br><span class="line">    half value0 : TEXCOORD0;  <span class="comment">//half中等精度的浮点值，通常用16位来存储，范围是-60000~60000</span></span><br><span class="line">    float2 value1 : TEXTCOORD1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一个语义可以用的寄存器只能处理4个浮点值(float)，如float3X4需要使用更多的空间，可以拆分为多个变量，每个变量存储了矩阵中的一行数据。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jiaq</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jiaq</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        




  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=732200829";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
